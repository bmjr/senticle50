import codecs
import os
import sys

import django
from tqdm import tqdm

sys.path.append(os.path.join(os.path.dirname(__file__), ".."))

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "brexit.settings.production")

django.setup()

from experiments.JaccardDistanceCalculator import JacquardsDistanceCalculator


def export():
    seed_hashtags = ["#VOTELEAVE", "#STRONGERIN", "BREXIT"]
    gathered_hashtags = ['#BREXIT', '#EU', '#UK', '#TRUMP', '#EUREF',
                         '#REMAIN', '#ARTICLE50', '#GE2017', '#UKIP',
                         '#VOTELEAVE', '#THERESAMAY', '#LEAVE',
                         '#EUREFRESULTS', '#EURO2016', '#INDYREF2', '#NHS',
                         '#BRITAIN', '#EUROPE', '#LABOUR', '#SCOTLAND',
                         '#EUREFERENDUM', '#POLITICS', '#LONDON', '#BBCQT',
                         '#BREXITSHAMBLES', '#FLEXCIT', '#TORY', '#TORIES',
                         '#MAGA', '#REALESTATE', '#TRAVEL', '#MAY', '#FOREX',
                         '#ENGLAND', '#CORBYN', '#BREXITVOTE', '#BORISJOHNSON',
                         '#BUSINESS', '#FINTECH', '#ECONOMY', '#LEAVEEU',
                         '#ENG', '#GOLD', '#TRADING', '#EEA', '#REFERENDUM',
                         '#DEMOCRACY', '#NEWS', '#FARAGE', '#GE17', '#ENGICE',
                         '#FREXIT', '#IMMIGRATION', '#BBC', '#STRONGERIN',
                         '#SCOTREF', '#GENERALELECTION', '#SILVER', '#BRITISH',
                         '#BINARY', '#LIBDEMS', '#STOPBREXIT',
                         '#EUROPEANUNION', '#IRELAND', '#USA',
                         '#BREXITBRITAIN', '#MARR', '#SNP', '#PROPERTY',
                         '#DONALDTRUMP', '#ELECTIONNIGHT', '#R4TODAY', '#PMQS',
                         '#LEADERSHIP', '#RACISM', '#TRADE', '#CAMERON',
                         '#TCOT', '#MERKEL', '#CONSERVATIVE', '#FRANCE',
                         '#BORIS', '#ENGISL', '#TECH', '#ELECTION2016',
                         '#USELECTION2016', '#WALES', '#BREMAIN', '#GIBRALTAR',
                         '#GERMANY', '#BBCDP', '#NIGELFARAGE', '#NEXIT',
                         '#BBCNEWS', '#POUND', '#TRUMP2016', '#EURO', '#US',
                         '#FINANCE', '#BREXITDAY', '#EXPATS', '#DAVIDCAMERON',
                         '#NEWSNIGHT', '#TRUMPTRAIN', '#LEPEN',
                         '#SUPREMECOURT', '#PM', '#EUROVISION', '#STARTUP',
                         '#BANKING', '#ICELAND', '#GBP', '#AUSPOL', '#BREGRET',
                         '#BREXITBILL', '#JOBS', '#CDNPOLI', '#SINGLEMARKET',
                         '#STOCKS', '#MANCHESTER', '#BRUSSELS',
                         '#UKREFERENDUM', '#BREAKING', '#RUSSIA',
                         '#BREXITORNOT', '#CONSERVATIVES', '#BREXITEERS',
                         '#JUNCKER', '#PUTIN', '#HARDBREXIT', '#CHINA',
                         '#STERLING', '#AUSTERITY', '#VOTE', '#STARTUPS',
                         '#ISL', '#INDYREF', '#PARLIAMENT', '#REGREXIT',
                         '#ELECTION', '#OBAMA', '#PRESIDENTTRUMP', '#MARKETS',
                         '#VOTEREMAIN', '#NOTMYVOTE', '#USELECTIONS',
                         '#AMERICA', '#TURKEY', '#C4NEWS', '#REMOANERS',
                         '#INDEPENDENCEDAY', '#SPAIN', '#NORTHERNIRELAND',
                         '#UNITEDKINGDOM', '#POUNDTOEURO', '#FAKENEWS',
                         '#CONSTRUCTION', '#REMAINERS', '#JEREMYCORBYN',
                         '#GREXIT', '#AMERICAFIRST', '#EU27', '#MEDIA', '#BOE',
                         '#CAPITAL', '#NOBREXIT', '#HR', '#SKYNEWS',
                         '#USELECTIONS2016', '#EUROPEAN', '#TONYBLAIR',
                         '#INVESTMENT', '#PHARMA', '#MIGRATION', '#YESEU',
                         '#PROJECTFEAR', '#BRIDGING', '#ITALY', '#FX',
                         '#ELECTIONDAY', '#ELECTION2017', '#BLAIR', '#MP',
                         '#BANKS', '#WEARETHE48', '#ART50',
                         '#GENERALELECTION2017', '#CLIMATECHANGE',
                         '#TORIESOUT', '#CPC16', '#HOUSING', '#GREATBRITAIN',
                         '#IVOTED', '#DRAINTHESWAMP', '#GDPR', '#VOTELABOUR',
                         '#MARMITE', '#WESTMINSTER', '#INDIA', '#TAX',
                         '#GOVERNMENT', '#EUCO', '#POPULISM', '#MAYHEMISM',
                         '#LAW', '#RECRUITMENT', '#NATO', '#FREEDOM', '#SYRIA',
                         '#BITCOIN', '#TEXIT', '#INVESTING', '#NICOLASTURGEON',
                         '#GBPUSD', '#GINAMILLER', '#EDUCATION', '#CANADA',
                         '#ITALEXIT', '#MACRON', '#BREXITSPEECH', '#BBCSP',
                         '#ECONOMICS', '#TTIP', '#BLM', '#DUP', '#AD',
                         '#WORLD', '#ENVIRONMENT', '#STURGEON', '#VC',
                         '#NISSAN', '#CABINET', '#USELECTION', '#CNN', '#ICID',
                         '#MARKETING', '#NEVERTRUMP', '#SCIENCE',
                         '#BREXITIN5WORDS', '#ENERGY', '#MONEY', '#CCOT',
                         '#ECB', '#AUSVOTES', '#HILLARY', '#AUTUMNSTATEMENT',
                         '#ISIS', '#THERESAMAYPM', '#FED', '#AFD',
                         '#HOUSEOFLORDS', '#XENOPHOBIA', '#GAMEOFTHRONES',
                         '#STRONGANDSTABLE', '#BERLIN', '#INFLATION',
                         '#CLINTON', '#WHATHAVEWEDONE', '#INSURANCE',
                         '#INVESTORS', '#HUMANRIGHTS', '#SKYPAPERS',
                         '#HEALTHINNOVATIONS', '#BBCDEBATE', '#EUREFRESULT',
                         '#CETA', '#GREECE', '#RETAIL', '#EUNITED',
                         '#INDEPENDENCE', '#TORYELECTIONFRAUD',
                         '#MANUFACTURING', '#DATA', '#FOREIGNSECRATERY',
                         '#UKMFG', '#PESTON', '#ICEBERG', '#MARCHFOREUROPE',
                         '#2016', '#ISLAM', '#UKDECIDES', '#NWO',
                         '#DAVIDDAVIS', '#MIGRANTS', '#TECHNOLOGY',
                         '#NOWAYMAY', '#VOTEIN', '#EUROZONE', '#BRITS',
                         '#PARIS', '#SME', '#GB', '#MSM', '#BREXITCOST',
                         '#BATTLEFORNUMBER10', '#FASCISM', '#UKELECTION2017',
                         '#POTUS', '#FARMING', '#STRATEGY', '#FUNDING',
                         '#TRUMPPRESIDENT', '#BREXITERS', '#PEGIDA',
                         '#REFUGEES', '#SCOTTISH', '#SMES', '#MUSTREAD',
                         '#HUNGPARLIAMENT', '#CURRENCY', '#A50', '#AUSTRALIA',
                         '#INNOVATION', '#BLOCKCHAIN', '#PRIMEMINISTER',
                         '#GROWTH', '#ELECTIONS2016', '#HISTORY', '#ENGLISH',
                         '#NOTINMYNAME', '#ARTICLE50BILL', '#IRISH',
                         '#RICHMONDPARK', '#WATO', '#HEATHROW', '#RESIST',
                         '#FAIL', '#UNITEFOREUROPE', '#UKECONOMY',
                         '#OBAMAGATE', '#BLOG', '#DIGITAL', '#POLAND',
                         '#AIRPOLLUTION', '#MARKET', '#NATIONALISM',
                         '#LEAVELIES', '#RT', '#UKPOLITICS', '#FOOD',
                         '#MARMITEGATE', '#NIRELAND', '#HIGHERED', '#LIES',
                         '#CLIMATE', '#WTF', '#BRITAINFIRST', '#OIL',
                         '#BREAKINGNEWS', '#SOCIALMEDIA', '#AFRICA', '#BBCAQ',
                         '#SHARETHEFACTS', '#DELHI', '#FACTCHECK',
                         '#TERESAMAY', '#CYBERSECURITY', '#TAKEBACKCONTROL',
                         '#SECURITY', '#BREXITDEBATE', '#DAILYMAIL',
                         '#LABOURCOUP', '#LIBDEM', '#GERMAN',
                         '#COALITIONOFCHAOS', '#BOJO', '#FB', '#RESEARCH',
                         '#LEXIT', '#SOVEREIGNTY', '#RACE', '#JAPAN', '#OUT',
                         '#TUSK', '#BREXSHIT', '#PJNET', '#FUTURE', '#FTSE',
                         '#FINANCIAL', '#WTO', '#STOCKMARKET', '#EXIT',
                         '#ECONOMIC', '#PETITION', '#BUDGET2017', '#TRIDENT',
                         '#DISABILITY', '#UE', '#LIBDEMFIGHTBACK', '#ART',
                         '#MAYHEM', '#IMWITHHER', '#SWEXIT', '#IREXIT',
                         '#GOVE', '#MAKEAMERICAGREATAGAIN', '#EDL',
                         '#UKELECTION', '#RACIST', '#JC4PM', '#LEGAL',
                         '#BIGDATA', '#FRENCH', '#PVV', '#HEALTH',
                         '#EMPLOYMENT', '#IMF', '#BREXITMEANSBREXIT', '#MPS',
                         '#ALTRIGHT', '#RIO2016', '#UN', '#STOKECENTRAL',
                         '#JOBSEARCH', '#GOP', '#LBC', '#ASTROLOGY',
                         '#STOKEBYELECTION', '#SUPPLYCHAIN', '#ENTREPRENEUR',
                         '#UKREF', '#CUTS', '#GLOBALBRITAIN',
                         '#SCOTLANDINEUROPE', '#EXPORT', '#APPLE',
                         '#MARINELEPEN', '#WEDNESDAYWISDOM', '#FRANKFURT',
                         '#DUBLIN', '#HILLARYCLINTON', '#NEVERHILLARY',
                         '#BRIGHTON', '#HATECRIME', '#BBCPM', '#GREENS',
                         '#POSTREFRACISM', '#PIZZAGATE', '#PODCAST',
                         '#TERRORISM', '#WEDEMAND', '#PEDOGATE',
                         '#PROCUREMENT', '#ANGLETERRE', '#BLACKFRIDAY', '#GO',
                         '#ECOMMERCE', '#IVOTEDLEAVE', '#FOOTBALL',
                         '#OPENBRITAIN', '#NI', '#GREATREPEALBILL', '#SOROS',
                         '#BREXITFAIL', '#BREXITNOW', '#LORDS', '#AI',
                         '#TOBLERONE', '#RISK', '#FOREIGNSECRETARY', '#SWEDEN',
                         '#JOHNSON', '#ESA', '#LEAVERS', '#TWITTER',
                         '#TOURISM', '#GLOBAL', '#IMMIGRANTS', '#SOCIALCARE',
                         '#CORNWALL', '#STOPARTICLE50', '#CITY', '#WELFARE',
                         '#COMMONWEALTH', '#NHSCRISIS', '#VOTEDLEAVE',
                         '#TESCO', '#RECESSION', '#TRUMPPENCE16', '#LANDLORDS',
                         '#MUSLIMBAN', '#STRONGERTOGETHER', '#1', '#WIKILEAKS',
                         '#UNILEVER', '#SKY', '#WEAKANDWOBBLY', '#SUNDERLAND',
                         '#BBCTW', '#ISITOK', '#UKHOUSING', '#PRIVACY',
                         '#JUSTSAYING', '#BREXITEVE', '#VOTECONSERVATIVE',
                         '#DOLLAR', '#WINE', '#LOL', '#REMAININEU',
                         '#REMOANER', '#GDP', '#THERESA', '#AGRICULTURE',
                         '#VENUS', '#GLOBALIZATION', '#HIGHCOURT',
                         '#LABOURPARTY', '#UKPOLI', '#DEBATE', '#DEXIT',
                         '#PENSIONS', '#CALEXIT', '#IRONY', '#FREETRADE',
                         '#SAD', '#ERDOGAN', '#SCOTTISHINDEPENDENCE',
                         '#PEGASUS', '#PEACE', '#POPULIST', '#FRIDAYFEELING',
                         '#ISRAEL', '#TRFINRISK', '#WHITEPAPER',
                         '#LABOURLEADERSHIP', '#GLOBALISM', '#FARRIGHT',
                         '#WAR', '#BANKOFENGLAND', '#MCGA', '#TRUMPWINS',
                         '#CORBYNOUT', '#HOLLANDE', '#INDY2', '#CRE',
                         '#TORYSMUSTGO', '#LOVE', '#DEMEXIT', '#BUSINESSES',
                         '#HAMMOND', '#ANGELAMERKEL', '#DISASTER', '#GBR',
                         '#TACTICALVOTING', '#FINANCIALSERVICES',
                         '#VENTURECAPITAL', '#GLOBALISATION', '#ELECTIONS',
                         '#NICE', '#IT', '#MILLENNIALS', '#NOMANDATEMAY',
                         '#UKGOV', '#STOKE', '#2NDREFERENDUM', '#TRUTH',
                         '#INVESTMENTS', '#FASHION', '#POLLS', '#G20',
                         '#UKRAINE', '#REMAINER', '#RIGHTS', '#HEARTNEWS',
                         '#GOOGLE', '#IP', '#TRNDNL', '#SMALLBUSINESS',
                         '#CHANGE', '#UKEMPLAW', '#LAB16', '#POLL',
                         '#LOCKHERUP', '#USD', '#CARNEY', '#THURSDAYTHOUGHTS',
                         '#HUNGARY', '#TRUMPRUSSIA', '#SATIRE', '#EU60',
                         '#CHRISTMAS', '#EUROS2016', '#DRAGHI', '#WAL',
                         '#DESIGN', '#TPP', '#IRAQ', '#BREXITINFIVEWORDS',
                         '#FEELTHEBERN', '#MORTGAGE', '#DATAPROTECTION',
                         '#BBCBIAS', '#NORWAY', '#BETTERTOGETHER', '#JOCOX',
                         '#EPLENARY', '#INVEST', '#ITV', '#FTSE100', '#P2',
                         '#NBADRAFT', '#CLOUD', '#GUARDIAN', '#NETHERLANDS',
                         '#UNIVERSITIES', '#RNCINCLE', '#MARRSHOW',
                         '#EUCITIZENS', '#IDIOTS', '#HEALTHCARE', '#TIMFARRON',
                         '#VOTEOUT', '#BUDGET', '#BTC', '#BANK', '#IN',
                         '#LIAMFOX', '#FREEMOVEMENT', '#STUDENTS',
                         '#REGULATION', '#REPORT', '#BIAFREXIT', '#CALAIS',
                         '#INDUSTRY', '#BREAKFAST', '#MUSLIMS', '#PERISCOPE',
                         '#SHAMBLES', '#LONDONSTAYS', '#VICTORIALIVE', '#VINB',
                         '#ROTHSCHILD', '#LOGISTICS', '#BBCELECTION', '#AE17',
                         '#OSBORNE', '#YELLEN', '#DEMENTIATAX', '#FUNNY',
                         '#MARINE2017', '#POLITICIANS', '#THERESISTANCE',
                         '#FACEBOOK', '#BARNIER', '#RUSSIAGATE',
                         '#TAKECONTROL', '#NO', '#BBCREFERENDUM', '#MACRO',
                         '#GBBO', '#MEGA', '#LEAVEWINS', '#VOTERS',
                         '#SMALLBIZ', '#BLAMETHETORIES', '#FOXNEWS',
                         '#POKEMONGO', '#POSTBREXIT', '#TORYMANIFESTO',
                         '#UNITEDIRELAND', '#BANKSY', '#HOSPITALITY',
                         '#DIVORCE', '#KEEPCORBYN', '#ITVNEWS', '#NIR',
                         '#LONDONISOPEN', '#EUPOL', '#POLITICAL', '#MSNBC',
                         '#PR', '#FREE', '#SCOTUS', '#EUDK', '#INVESTOR',
                         '#BRITONS', '#FARMERS', '#INEQUALITY', '#FACEPALM',
                         '#MUSLIM', '#PEOPLE', '#GOT', '#GENERALELECTION17',
                         '#NYC', '#DIVERSITY', '#WORLDNEWS', '#CROOKEDHILLARY',
                         '#ENTREPRENEURS', '#LITTLEBRITAIN', '#QUEEN', '#2017',
                         '#POLICY', '#SUSTAINABILITY', '#U', '#ANGISL',
                         '#BREXITLIES', '#EXPAT', '#MARKCARNEY', '#HOPE',
                         '#THERESAMAYHEM', '#XFACTOR', '#WALLSTREET',
                         '#CAMERONRESIGNS', '#WRITER', '#CHAOS', '#COLOMBIA',
                         '#SAVEOURNHS', '#MURDOCH', '#SCHENGEN', '#TEXAS',
                         '#CRISIS', '#DUMPTRUMP', '#DAVOS', '#AMEXIT',
                         '#UNCERTAINTY', '#YES', '#PWC', '#ICYMI', '#HS2',
                         '#AUSTRIA', '#MUSIC', '#FIXIT', '#FOX', '#GE',
                         '#POSTTRUTH', '#POVERTY', '#WALNIR', '#BREXITEER',
                         '#CONSULTING', '#EFTA', '#INFRASTRUCTURE',
                         '#RESPECTTHERESULT', '#LUXEMBOURG', '#EUROS',
                         '#EMPLOYMENTLAW', '#SECONDREFERENDUM', '#NAFTA',
                         '#IDS', '#AGENDA21', '#TRUMPFIRSTS',
                         '#ENGLANDVSICELAND', '#CORRUPTION', '#SVPOL',
                         '#BRISTOL', '#2017SHIFT', '#ITALYREFERENDUM',
                         '#BLOCK', '#NEGOTIATIONS', '#ENGVICE', '#EUREF2',
                         '#SWITZERLAND', '#HOUSEPRICES', '#KRTPRO',
                         '#NORTHEAST', '#ARTICLE', '#HATE', '#ERASMUS',
                         '#QUESTIONTIME', '#NUCLEAR', '#LGBT',
                         '#PRIVATEEQUITY', '#GEERTWILDERS', '#PRIDE2016',
                         '#OWENSMITH', '#THEARCHERS', '#FREEEUROPE', '#WEF17',
                         '#LITTLEENGLAND', '#BNP', '#MOON', '#MALTA',
                         '#LIBERAL', '#RIDGE', '#FFS', '#INTERESTRATES',
                         '#SNAPELECTION', '#PENSION', '#EXPORTS',
                         '#OPROTHSCHILD', '#IOT', '#LEAVEWATCH',
                         '#BREXITRULING', '#GLASTONBURY', '#NICKCLEGG',
                         '#AUTOMOTIVE', '#LIBERTY', '#MAKEBRITAINGREATAGAIN',
                         '#RESHUFFLE', '#DEVOLUTION', '#HOLYROOD', '#UKLABOUR',
                         '#IMWITHYOU', '#FN', '#ALEPPO', '#LOVEEUROPE',
                         '#WRIGHTSTUFF', '#ASIA', '#INAUGURATION',
                         '#YORKSHIRE', '#PUN', '#BIAFRA', '#VAT', '#CEO',
                         '#HEXIT', '#SOFTBREXIT', '#HYPOCRISY', '#GLOBALISTS',
                         '#EUROEXIT', '#PROPAGANDA', '#MONDAYMOTIVATION',
                         '#BOWIE', '#TURKEYCOUP', '#FF', '#REFUGEECRISIS',
                         '#EURUSD', '#TLOT', '#SHAME', '#LSE', '#DUPCOALITION']

    outputFile = codecs.open("Jaccard_Distance_Matrix.csv", "w+", "utf-8")

    column_labels = "hashtag,"

    for i in range(0, len(seed_hashtags)):
        column_labels += seed_hashtags[i] + ","

    outputFile.write(column_labels)

    progress = tqdm(total=len(gathered_hashtags))
    distance_matrix = JacquardsDistanceCalculator.get_distance_matrix(
        seed_hashtags, gathered_hashtags, progress)

    for i, hashtag in enumerate(gathered_hashtags):
        row = '\n' + hashtag + ','
        for j, _ in enumerate(seed_hashtags):
            row += str(distance_matrix[i][j]) + ','

        outputFile.write(row)

    outputFile.flush()


if __name__ == "__main__":
    export()
